<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Student Grades</title>
    <style>
        /* General table styling */
        #gradesTable {
            width: 100%;
            border-collapse: collapse;
        }
        #gradesTable th, #gradesTable td {
            padding: 8px;
            text-align: left;
            border: 1px solid #ddd;
        }
        #gradesTable thead {
            background-color: #f2f2f2;
        }

        /* Course Name Row */
        .course-name-row {
            font-weight: bold;
            background-color: #e7f3ff;
        }

        /* Indent for Quiz/Test rows */
        .grade-item-row .item-name {
            padding-left: 20px;
        }

        /* Item type and name styling */
        .item-type {
            display: block;
            font-weight: bold;
        }

        /* Student name styling */
        .student-name {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
    </style>
</head>
<body>
<h1>Điểm số của sinh viên</h1>

<!-- Displaying Student Name -->
<div th:if="${studentName != null}" class="student-name">
    <p>Student: <span th:text="${studentName}"></span></p>
</div>

<div th:if="${grades != null}">
    <table border="1" id="gradesTable">
        <thead>
        <tr>
            <th>Grade Item</th>
            <th>Calculated Weight</th>
            <th>Grade</th>
            <th>Percentage</th>
            <th>Feedback</th>
            <th>Contribution to Course Total</th>
        </tr>
        </thead>
        <tbody>
        <!-- Course Name Row with Toggle Button -->
        <tr class="course-name-row">
            <td th:text="${grades.courseName}" colspan="6">
                Course Name
                <button id="toggleButton" onclick="toggleItems()">Hide Items</button>
            </td>
        </tr>

        <!-- Grade Items Rows with Indentation -->
        <tr th:each="gradeItem : ${grades.gradeItems}" class="grade-item-row">
            <td>
                <!-- Display "Quiz" or "Test" only if it’s not "Course total" -->
                <span th:if="${!gradeItem.itemName.contains('Course total')}"
                      th:text="${#strings.startsWith(gradeItem.itemName, 'Quiz') ? 'Quiz' : 'Test'}"
                      class="item-type"></span>
                <span th:text="${gradeItem.itemName.replace('Quiz', '').replace('Test', '').trim()}" class="item-name"></span>
            </td>
            <td th:text="${gradeItem.weight}"></td>
            <td th:text="${gradeItem.grade}"></td>
            <td th:text="${gradeItem.percentage}"></td>
            <td th:text="${gradeItem.feedback}"></td>
            <td th:text="${gradeItem.contributionToCourseTotal}"></td>
        </tr>
        </tbody>
    </table>
</div>

<p th:if="${grades == null || grades.gradeItems.isEmpty()}">Không có điểm nào cho sinh viên trong khóa học này.</p>

<script>
    function toggleItems() {
        const gradeItemRows = document.querySelectorAll(".grade-item-row");
        const toggleButton = document.getElementById("toggleButton");

        gradeItemRows.forEach(row => {
            row.style.display = (row.style.display === "none" ? "" : "none");
        });

        toggleButton.textContent = (toggleButton.textContent === "Hide Items") ? "Show Items" : "Hide Items";
    }

    document.addEventListener("DOMContentLoaded", function() {
        const gradeItemRows = document.querySelectorAll(".grade-item-row");
        gradeItemRows.forEach(row => row.style.display = "");
    });
</script>

</body>
</html>
